#!/usr/bin/perl -w                
#!perl -w                
require "jrw.pl";
require "rftraceLib.pl";
# REQUIRES jrw.pl and rftraceLib.pl
#
$VERSION = "0.1";
#--------------------------------------------------------------------------
# Date       Version Author       Comment
# ---------- ------- -----------  --------------------------------------------
# 03/28/2007 0.1     jwerwath     initial  
#--------------------------------------------------------------------------
use CGI;


$HTML_SPACE = " "; # "&nbsp;"
$HTML_NEWLINE = "<br>";
$q = CGI::new();
$data = $q->param("data");
$example = $q->param("example");
$reset = $q->param("reset");
$submit= $q->param("submit");
print $q->header();
print "<script></script>";
print "<h1 align=center>Pretty HTML version $VERSION</h1><form method=post><textarea cols=106 rows=32 name=data>";

if ( ! $example)
{
  if ( ! $reset)
  {
  print "Cut and paste your html here.";
  }
	else 
	{
	 $data = "";
	}
}
else
{
  print <<END_OF_AMAZON;
<html>
<head>
<base href="http://v80.novarra.net/__aHR0cDovL3Q1MC5ub3ZhcnJhLm5ldC9wZXJmb3JtYW5jZS9hbWF6b24uY29tL3d3dy5hbWF6b24uY29tL2V4ZWMvb2JpZG9zL3N1YnN0L2hvbWUvaG9tZS5odG1sLzEwNC02NTA4MDc1LTE0NzU5MzEuaHRt/"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><style type="text/css"> body {font-size:11.0;} .n1 {background-color:#ffffff;color:#333333;font-size:11.0;} .n2 {background-repeat:no-repeat;font-size:11.0;} .n3 {color:#333333;font-size:11.0;text-decoration:none;} .n4 {color:#333333;font-size:11.0;} .n5 {color:#003399;font-size:12.0;text-decoration:none;} .n6 {color:#333333;font-size:11.0;text-decoration:none;text-transform:capitalize;} .n7 {color:#000000;font-size:14.0;font-weight:bold;text-transform:capitalize;} .n8 {font-size:13.0;} .n9 {background-color:#f4f4e3;font-size:11.0;} .n10 {background-color:#ffffff;color:#000000;font-size:11.0;} .n11 {background-color:#ffffdd;font-size:9.0;} .n12 {color:#cc6600;font-size:9.0;font-weight:bold;} .n13 {color:#003399;font-size:9.0;} .n14 {color:#000000;font-size:11.0;} .n15 {background-color:#006699;color:#000000;font-size:11.0;} .n16 {color:#ffffff;font-size:10.0;font-weight:bold;text-transform:uppercase;} .n17 {background-color:#708090;color:#000000;font-size:11.0;} .n18 {background-color:#ffffff;font-size:11.0;} .n19 {font-size:9.0;} .n20 {font-size:7.0;} .n21 {color:#003399;font-size:7.0;} .n22 {color:#cc6600;font-size:9.0;} .n23 {font-size:9.0;font-weight:bold;} .n24 {background-color:#99cc00;color:#000000;font-size:11.0;} .n25 {color:#cc6600;font-size:11.0;font-weight:bold;} .n26 {font-size:11.0;font-weight:bold;} .n27 {color:#003399;font-size:9.0;font-weight:bold;} .n28 {color:#003399;font-size:9.0;font-style:italic;font-weight:bold;} .n29 {color:#003399;font-size:9.0;font-style:italic;} .n30 {background-color:#999999;color:#000000;font-size:11.0;} .n31 {background-color:#ffffff;color:#000000;font-size:9.0;} .n32 {background-color:#ffcc66;color:#000000;font-size:11.0;} .n33 {color:#003399;font-size:11.0;} </style><title>Amazon.com: Online Shopping for Electronics, Apparel, Computers, Books, DVDs & more </title></head><body style="background-color:#ffffff"><form method=post action="genformsub/130614046/0">
<input type="hidden" name="novWml20EvtJS" value="130614046"/>
<input type="hidden" name="novWml20EvtTopNode" value="7195"/><div style="background-color: #eee;border: outset; margin-top: 1em; margin-bottom: 1em; padding-left: 1em;padding-top: 0.5em; padding-bottom: 0.7em"><a accesskey="0" href="/servlet/startPg">nWebHome</a> <a href="/servlet/userprof?p=bm&f=a&fromUrl=http%3A%2F%2Ft50.novarra.net%2Fperformance%2Famazon.com%2Fwww.amazon.com%2Fexec%2Fobidos%2Fsubst%2Fhome%2Fhome.html%2F104-6508075-1475931.htm&url=http%253A%252F%252Ft50.novarra.net%252Fperformance%252Famazon.com%252Fwww.amazon.com%252Fexec%252Fobidos%252Fsubst%252Fhome%252Fhome.html%252F104-6508075-1475931.htm&faviconUrl=http%3A%2F%2Ft50.novarra.net%2Ffavicon.ico-fvk3y&fromTitle=%0AAmazon.com%3A+Online+Shopping+for+Electronics%2C+Apparel%2C+Computers%2C+Books%2C+DVDs+%26+more%0A+&title=%0AAmazon.com%3A+Online+Shopping+for+Electronics%2C+Apparel%2C+Computers%2C+Books%2C+DVDs+%26+more%0A+"> Add Bookmark</a> <input  type="submit" name="PNov-more7165;" value="Prev"/><input  type="submit" name="PNov-more7165;" value="1"/><b> 2 </b><input  type="submit" name="PNov-more7228;" value="3"/><input  type="submit" name="PNov-more7265;" value="4"/><input  type="submit" name="PNov-more7283;" value="5"/> ... <input  type="submit" name="PNov-more7395;" value="10"/><input  type="submit" name="PNov-more7228;" value="Next"/><a href="/t50.novarra.net/"> Home</a> <br/></div><img width="120" height="30" alt="" src="/t50.novarra.net/performance/amazon.com/g-images.amazon.com/images/G/01/gourmet/winecom_logo_120.gif" border="0"/><br/><div style="background-color: #ffffff;color: #000000;"><div class="n1"><div class="n1"><div class="n1"><select  name="313"><option  selected value="index=blended">Amazon.com </option><option  value="index=stripbooks">Books </option><option  value="index=music">Popular Music </option><option  value="index=music-dd">Music Downloads </option><option  value="index=classical">Classical Music </option><option  value="index=dvd">DVD </option><option  value="index=vhs">VHS </option><option  value="index=apparel-index&platform=gurupa">Apparel </option><option  value="index=local-index&platform=gurupa">Yellow Pages</option><option  value="index=restaurants">Restaurants </option><option  value="index=theatrical">Movie Showtimes </option><option  value="index=toys">Toys </option><option  value="index=baby">Baby </option><option  value="index=pc-hardware">Computers </option><option  value="index=videogames">Video Games </option><option  value="index=electronics">Electronics </option><option  value="index=photo">Camera & Photo </option><option  value="index=software">Software </option><option  value="index=tools">Tools & Hardware </option><option  value="index=office-products">Office Products </option><option  value="index=magazines">Magazines </option><option  value="index=sporting-index&platform=gurupa">Sports & Outdoors </option><option  value="index=garden">Outdoor Living </option><option  value="index=kitchen">Kitchen </option><option  value="index=jewelry-index&platform=gurupa">Jewelry & Watches </option><option  value="index=beauty-index&platform=gurupa">Beauty </option><option  value="index=gourmet-index&platform=gurupa">Gourmet Food Beta </option><option  value="index=mi-index&platform=gurupa">Musical Instruments </option><option  value="index=hpc-index&platform=gurupa">Health/Personal Care </option><option  value="index=books&field-browse=27&store-name=travel">Travel </option><option  value="index=wireless-phones">Cell Phones & Service </option><option  value="index=outlet">Outlet </option><option  value="index=auction-redirect">Auctions </option><option  value="index=fixed-price-redirect">zShops </option><option  value="index=misc">Everything Else </option><option  value="index=moc-scientific-supplies">Scientific Supplies </option><option  value="index=moc-medical-supplies">Medical Supplies </option><option  value="index=moc-industrial-supplies">Indust. Supplies </option><option  value="index=automotive-index&platform=gurupa">Automotive </option><option  value="index=moc-home-furnishings">Home Furnishings </option><option  value="index=moc-lifestyle">Lifestyle </option><option  value="index=moc-pet-toys">Pet Toys </option><option  value="index=moc-arts-hobby">Arts & Hobbies </option></select> <br/><a name="NovSearch"> &nbsp;</a><input  type="text" name="456" value=""/> <input  class="" type="image" src="/t50.novarra.net/performance/amazon.com/g-images.amazon.com/images/G/01/buttons/go-orange-trans.gif" width="21" height="21" alt="Go" name="PNov-Submit474;"/> </div><div class="n1"><div class="n1"><a name="findGift|he|findGifts" href="javascript/130614046/518"> <img width="99" height="32" alt="Find Gifts" src="/t50.novarra.net/performance/amazon.com/g-images.amazon.com/images/G/01/gifts/giftcentral/1/buybox-button-find-gifts.gif" border="0"/></a> <br/><div class="n1"><a href="javascript/130614046/558"> <img width="91" height="25" alt="Search Web" src="/t50.novarra.net/performance/amazon.com/g-images.amazon.com/images/G/01/nav2/images/skins/holiday-2005/cap-a9.gif" border="0"/></a> <span class="n9"><input  maxlength="256" type="text" name="570"/> </span><input  align="absmiddle" class="" type="image" src="/t50.novarra.net/performance/amazon.com/g-images.amazon.com/images/G/01/nav2/images/skins/holiday-2005/endcap-a9-go.gif" width="25" height="25" alt="Go" name="PNov-Submit580;"/> </div></div></div></div></div><div class="n10"><div class="n11"><b class="n12">Hello.</b> Sign in to get <a class="n13" href="javascript/130614046/627"> personalized recommendations</a>. New customer? <a class="n13" href="javascript/130614046/631"> Start here</a>. </div></div><div class="n10"><div class="n10"><div class="n15"><img width="5" height="5" alt="eyebrow-upper-left-corner.gif" src="/t50.novarra.net/performance/amazon.com/g-images.amazon.com/images/G/01/x-locale/common/icons/eyebrow-upper-left-corner.gif"/> <br/><div class="n15"></div></div></div></div></div><div style="background-color: #eee;border: outset; margin-top: 1em; margin-bottom: 1em; padding-left: 1em;padding-top: 0.5em; padding-bottom: 0.7em"><a accesskey="0" href="/servlet/startPg">nWebHome</a> <a href="/servlet/userprof?p=bm&f=a&fromUrl=http%3A%2F%2Ft50.novarra.net%2Fperformance%2Famazon.com%2Fwww.amazon.com%2Fexec%2Fobidos%2Fsubst%2Fhome%2Fhome.html%2F104-6508075-1475931.htm&url=http%253A%252F%252Ft50.novarra.net%252Fperformance%252Famazon.com%252Fwww.amazon.com%252Fexec%252Fobidos%252Fsubst%252Fhome%252Fhome.html%252F104-6508075-1475931.htm&faviconUrl=http%3A%2F%2Ft50.novarra.net%2Ffavicon.ico-fvk3y&fromTitle=%0AAmazon.com%3A+Online+Shopping+for+Electronics%2C+Apparel%2C+Computers%2C+Books%2C+DVDs+%26+more%0A+&title=%0AAmazon.com%3A+Online+Shopping+for+Electronics%2C+Apparel%2C+Computers%2C+Books%2C+DVDs+%26+more%0A+"> Add Bookmark</a> <input  type="submit" name="PNov-more7165;" value="Prev"/><input  type="submit" name="PNov-more7165;" value="1"/><b> 2 </b><input  type="submit" name="PNov-more7228;" value="3"/><input  type="submit" name="PNov-more7265;" value="4"/><input  type="submit" name="PNov-more7283;" value="5"/> ... <input  type="submit" name="PNov-more7395;" value="10"/><input  type="submit" name="PNov-more7228;" value="Next"/><a href="/t50.novarra.net/"> Home</a> <br/></div>

</form>
</body>

</html>
END_OF_AMAZON

}

print "</textarea><br><input name=submit type=submit value='Pretty up this HTML !'>";
print "<input type=submit name=example value='Show me example HTML !'>";
print "<input type=submit name=reset value=Reset></form>";
print "<script>document.forms[0].elements[0].select();</script>";

print "<a href='mailto:jwerwath\@novarra.com'>Comments, complaints, suggestions, bugs, etc.</a><hr>";

$debug = "";
if ($data)
{
   $out = &nicexml($data);
   print "<h3>Output:</h3><pre>$out</pre>";
}
else
{ 
   println("NO DATA ENTERED !<br>");
}

sub println
{
  my $s = shift;
  print $s .  "<br>\n";
}


sub nicexml
{
   my $xml = shift;
   #remove all newlines (FIXME - should ignore if in PRE)
   $xml =~ s/\n//g;
   #force each start and end tag on a new line.
   $xml =~ s/</\n</g;

   my $output = "";
  

  my @xmllines = split(/\n/,$xml);
  $indent = 0;
  $output = "";
 foreach (@xmllines)
  {
   
    #---START TAG
    if (/^<\w/)
    {
       $indent = $indent + 1;
    }

    #--- Do indenting
    foreach $i (0 .. $indent)
    {
      $_ = $HTML_SPACE . $_; 
    }

    if (/\/>/) #self-closing tag
    {
        $indent = $indent - 1;
    }

    elsif (/<\//)
    {
       $indent = $indent - 1;
      
    }

    #s/</&lt;/;
    #s/>/&gt;/;
    s/\r//g;
    s/\s/ /g;

 #--- Add what we have to total output.
    $output = $output . "$_". "\n";

    

  #if end tag

  }#end foreach

    #---Make < and > HTML printable
    $output =~ s/</&lt;/g;
    $output =~ s/>/&gt;/g;
  return $output;
}#end nicexml





