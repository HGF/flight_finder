#!/usr/bin/perl -w
#!perl -w                
# REQUIRES jrw.pl and rftraceLib.pl
#
#
#--------------------------------------------------------------------------
# 11/23/2005 Add support for gzip content                                 -
# 12/12/2005 Add version number, chop to each line
#--------------------------------------------------------------------------
require "jrw.pl";
require "rftraceLib.pl";
use CGI;


$HTML_SPACE = " "; # "&nbsp;"
$HTML_NEWLINE = "<br>";
$q = CGI::new();
$data = $q->param("data");
$example = $q->param("example");
$reset = $q->param("reset");
$submit= $q->param("submit");
print $q->header();
print "<script></script>";
print "<h1 align=center>RFTRACE XML EXTRACTOR version 0.2</h1><form method=post><textarea cols=106 rows=32 name=data>";

if ( ! $example)
{
  if ( ! $reset)
  {
  print "Cut and paste your trace here.  It should be exactly as wide as this textbox (106 characters).";
  }
	else 
	{
	 $data = "";
	}
}
else
{
	if ($example eq
		"Show me example compressed data !")
	{
  print <<END_OF_AMAZON;
      . . . . 5 . . . . 0 . . . . 5 . . . . 0 . . . . 5 . . . . 0 . .
0000 436F6E74656E742D547970653A20746578742F786D6C0D0A436F6E74656E742D     Content-Type: text/xml..Content-
0001 4C6F636174696F6E3A20687474703A2F2F3139392E3137372E31322E35302F70     Location: http://199.177.12.50/p
0002 6572666F726D616E63652F616D617A6F6E2E636F6D2F7777772E616D617A6F6E     erformance/amazon.com/www.amazon
0003 2E636F6D2F657865632F6F6269646F732F73756273742F686F6D652F686F6D65     .com/exec/obidos/subst/home/home
0004 2E68746D6C2F3130342D363530383037352D313437353933312E68746D0D0A4E     .html/104-6508075-1475931.htm..N
0005 6F76617272612D43616368652D436F6E74726F6C3A206D61782D6167653A2038     ovarra-Cache-Control: max-age: 8
0006 3234350D0A4E6F76617272612D506167652D49643A203134323034353538390D     245..Novarra-Page-Id: 142045589.
0007 0A4E6F76617272612D5552493A20687474703A2F2F3139392E3137372E31322E     .Novarra-URI: http://199.177.12.
0008 35302F706572666F726D616E63652F616D617A6F6E2E636F6D2F7777772E616D     50/performance/amazon.com/www.am
0009 617A6F6E2E636F6D2F657865632F6F6269646F732F73756273742F686F6D652F     azon.com/exec/obidos/subst/home/
0010 686F6D652E68746D6C2F3130342D363530383037352D313437353933312E6874     home.html/104-6508075-1475931.ht
0011 6D0D0A436F6E74656E742D456E636F64696E673A20677A69700D0A4E6F766172     m..Content-Encoding: gzip..Novar
0012 72612D436F6E74656E742D4C656E6774683A2031353937370D0A436F6E74656E     ra-Content-Length: 15977..Conten
0013 742D4C656E6774683A20343330360D0A0D0A1F8B0800000000000000D55BEB72     t-Length: 4306...............[.r
0014 DB38B27E15AC269B9CDDB2C49B288A398EB71227B1938D13D5C893D49E3F2988     .8.~..&......(.9...'.........?).
0015 8444C414C12240294AED8FF32853FB6F5F63F64DF649B61B2425CA026D8F2799     .D..."@)J...(S.o_c.M.I..\$\%..m.'.
0016 9D51D9BA900DA0BBF1A16F008FC56CB64CC98C4A96146CFEA49728953FB62C27     .Q........o...l.L..J..l...(.?.,'
0017 0C074E100C1C77E0DB56CE8AB92896348B984597F48BC80691585AEBF57AD0FA     ..N...w..V...(.4..E......XZ..z..
0018 C93EB3C812331E0B69C9722695958825D36F83442D53AB77729C301A9F1C2BAE     .>...3..i.r&...%.o.D-S.wr.0...+.
0019 5276F274DBF4317997A53C63649A883CE7D982C070E445CA2255888C47F2883C     Rv.t..1y..<cd..<....p.E."U..G..<
0020 CD735AB0F4889C8A655E2A56C0B567425CC1C7F3F7CF25794896A260E4D8AAFA     .sZ.....e^*V..gB\\.....\%yH..`....
0021 3EB6AA916622DE90D92212A9289EF4BE9BEB578F34BF6DFD02BE28D9131FFBB2     >...f"..."..(.....W.4.m...(.....
0022 9CA16B0F7D7F1C5AA361E0FEF95B6AC6B187FD916F8FEDC0EF3BC3C00F3D076F     ..k.}.Z.a...[j.....o....;...=.o
0023 F44EDED2D5B1454FC86F94C1EFDE8AD594D1224A7A27D567C56D525827C77CB9     .N....EO.o........"Jz'.g.mRX'.|.
0024 20F9931E90873D9230BE48D4939E67F7C89AC72A811B2E7CA7295C5CC3DC231F      .....=.0.H...g....*...|.)\\\\..#.
0025 3D228BE8496F30B0AEFD2DFA7C49174CB679AEAE586796ED580B51164BA62CEC     ="..Io0...-.|I.L.y..Xg..X.Q.K.,.
0026 08EE7D4CC5427C84FE070B0EB33D1345CC60BAED1E703543D662BED26FD78170     ..}L.B|......=.E.`...p5C.b..o..p
0027 081584464697EC492F5BB3D9C725E5195C03218F73E86BDB3E8A46230DA4D9C9     ...FF..I/[...%..\\.!.s.k.>.F#....
0028 94AE182973A204F1ED3F1291918958B3824CE95A023E6727FA5FB341B57EC6CE     ...)s....?....X..L.Z.>g'._.A.~..
0029 B8B7D3D618B5D268CB715AEA72B4BAF8227BD24BD95CDD5B592AB1A02F4B0991     .......h.qZ.r..."{.K.\\.[Y*../K..
0030 CABE6F8BF9FC23FC36A80AA7F2037B04E2A428018B495EF088499409144E9272     ..o...#.6.....{...(..I^..I...N.r
0031 C18864B84C395E9A93462277DC5E639E1786BD935C6B418216B0E301792BD684     ..d.L9^..F"w.^c.....\\kA.....y+..
0032 4BA21246145F32D497A2578CD078453305EC62873C8B605C3E4B1989194DF5D0     K..F._2...W..xE3..b.<.`\\>K...M..
0033 0B96B182A6FDBC2C7221B1210842520E6D9BF13DF770FC82453C2F4444151818     .......,r!.!.BR.m..=.p..E&lt;/DD...
0034 64E168473E3A248F781195292D2A4A9AC55BEAA17D48FD89EB2EB578402DC99A     d.hG>:\$.x..)-*J..[..}H.....x\@-..
0035 A5297E420F0B141B0C1B6152B24C711443965182B7B77D0E0FFB5414C4D6BDEE     .)~B......aR.Lq.C.Q...}...T.....
0036 8D6E50ED928341DC8EAFC9650EE2025ABEC0AC1914E41B14348376FB7AF10D7A     .nP...A....e...Z........4.v.z..z
0037 915121D2F4502B23835614AF0540B606E46FA27C045A997368B69DCD5901BD48     .Q!..P+#.V...\@...o.|.Z.sh...Y..H
0038 B2112589684654514AB5CFEBC8A09BD72F2EF7591D19D47256F02F5FD2CD3E61     ..%.hFTQJ......./..Y...rV./_..>a
0039 6090FC39FB0076E81A9D41F6674256166E473636887D41AFB8A2D7E80C429C03     `..9..v...A.gBV.nG66.}A......B..
0040 5594F09D2ED1AA0F48651BCAF4E438E55B1B111ADA3F6F74A8E77FBBB4C0C860     U.......He....8.[....?ot......`
0041 C35DE3D03630B96DDC00FDA6F6065D6CDB03F46F68EA18D55D37D508BFDED842     .]..60.m......]l...oh...]7.....B
0042 C9ADBC36915D56F60D581300CA040D1279B102F1A1BFA1DB7F95C1C29AA4542E     ...6.]V..X......y............T.
0043 29B97C4FE6855892E9260593C2A9C9F8866ED832BEE0D676C677E46F6D6FF895     ).|O..X..&.......n.2...v.w.omo..
0044 4C2FDB853416D8A225B8DB86B93E30FF72D27FF1FCF27D3FB4079FF285C11ABF     L/..4...%....>0.r....}?........
0045 528F2A8BA90D312E1AB4CE33C632B2A65CD591D3634DD208683257CDA064341E     R.*...1....3.2..\\...cM..h2W..d4.
0046 BA931717A8398E9A9BA754F5739AB1942027246F34A987C7A8EC13AECF078E0B     .....9....T.s... '\$o4...........
0047 5106FC91CB046C386889815D4036A00D5C00B973B0B338BB6BAE1260572C0A30     Q.....l8h..]\@6..\\..s..8.k..`W,.0
0048 7F7CC5FA129739A23D0135F76306E6806BFF2141BF088CCA773A106CF001482C     |....9.=.5.c...k.!A....w:.l..H,
0049 C98AAF787C54D1472253050516721EA91222BEDA85609C03BA05EF1157BD4117     ...x|T.G"S...r..."...`......W.A.
0050 34DB100C619080C20A1990D3844557E0BB54152D024F54ED9CDA566386B5B605     4...a........EW..T.-.OT...Vc....
0051 117973FA1CA4042B7FF9DE82D013659D09592DE0F668446EA462CBDADBDD8EE8     .ys....+.....e..Y-..hDn.b......
0052 F3328BC1D749747B3AA405F70028C78F07A34118802FD4923E83F586E34E291A     .2...It{:....(....A../..>....N).
0053 5703A247761BD123AF154EB8CE0ED2C1DD20DD09E889F50C6326FFF5C5D3F381     W..Gv..#..N...... ......c&......
0054 ED40B079F9FDFFC1EB3A744922731A410005CB69557FF51A40373C077E9BE760     .@.y.....:tI"s.A...iU..\@7<.~..`
0055 6CE6791CFE629E479EED7BF678E4879A67EF1E3CEB000F10965C9FB07A821A99     l.y..b.G..{.x...g..<.....\\..z...
0056 42C3C2DB9F3C7AF20780A4C020461B2A8D1C40234D01EC0A3085EB28658AE1B2     B....<z..... F.*..\@#M...0..(e...
0057 928C4A91C1C5DAB5135621BD861E8437105CA41BF8A2011D6F4194B64064F42E     ..J......V!....7.\\......oA..\@d..
0058 AE6D7210EFD0A8C2ADAA1F5CFA150C196DA2FC7D5B0FA40637A17BF15B9DB418     .mr........\\....m..}[...7.{.[...
0059 0AA03B734F26AFD18AAB47818EAB414795620ACE8CEE073A3284059730478950     ..;sO&....G...AG.b.....:2...0G.P
0060 0AFDC796ADAAE3A10F1DCFE7D7BD51BEC5A66BBBFE0E9BE12E38B7EFED133EF7     ..............Q...k......8....>.
0061 53084A5366C18DA5C82C0101D182F5695188F56150FE309BC9FC7F49239F6730     S.JSf....,.....iQ..aP.0...I#.g0
0062 556742C7D2097AD63AFED2D6E7560B84D937B984FF098FAE349CEBAC1BB2EBA7     UgB...z.:....V...7......4.......
0063 11D848292A4D1F181DD7F69D5E4B49FEF01BE730B60D29A97E1F5AE3A1350AE0     ..H)*M......^KI....0..).~.Z..5..
0064 A76D3BC3F1701440EEDB91CB241BED2649095178AA3514D30DA173B4D69709CD     .m;..p.\@....\$..&I.Qx.5....s.....
0065 AEE4025C0D38D17502AEAC09491B11470650CA162821D9CBC45A8F5427480A74     ...\\.8.u....I..G.P..(\!...Z.T'H.t
0066 996B5D22C4962C3B226BA13F70C55EF1B85BC9033235E54395C7825181CB7AE1     .k]"..,;"k.?p.^..[..25.C...Q..z.
0067 2BE43561698E0C17908ECD911B097930C6D5181D529960EE261455027BBE1D09     +.5ai.........y0....R.`.&.U.{...
0068 DF8B1983EEA729CF735D6AC18126AF2B39FE86A2BD112BE8F35D761D0E554807     ......).s]j..&.+9.....+..]v..UH.
0069 5D4AB49804300C5FDC3DDB1A416A94A39FCE1660D2ABDF6863F56F1C5F15F01F     ]J...0._.=..Aj.....`...hc.o._...
0070 9B73713D13100CB7C0168E5A2BD2FEEA311BADA6A789D70A504D6780766CA9F8     .sq=.......Z+...1.......PMg.vl..
0071 66DE7105EC7877D0D0FD7ABCCB7A3E7F09FFEEA8CDBF3BFE35F9CF3FDDC6BAA5     f.q..xw...z..z>......;.5..?....
0072 B1D3899F99FEAB253185791AF855772D54FFFBFFFFD15801C794395FB04CB739     .......%1.y..Uw-T.....X...9_.L.9
0073 A035789F0F68008CD4A63CF78C17A9345207A6E8426C3A880D9E79CA18790AE9     .5x..h....<....4R...Bl:...y..y..
0074 F84E64BD806F40C09EF6C606D91A7B71A30243032F1D0A046FFB3314E8DAA61A     .Nd..o\@.......{q..C./...o.3.....
0075 40970261FEEFAE40D7352551B502F7A4FE393A744D65AA09FD048BE14615BAA6     \@..a...\@.5\%Q.....9:tMe......F...
0076 94AE4B854383BABB55684277B70A4DF8EE54A109DE8D0ADB42EF34A817B3A53D     ..K.C...UhBw..M..T......B.4....=
0077 4A7339EFF6596FD9BA8AA2F384A7428A3CD93C26D335631024A2D7042F0631C2     Js9..Yo.......B.<.<&.5c.\$.../.1.
0078 1FC9294DD1C3F65F42BEFAEBFB2ECF6EDB7FCF76BF71A03463B4541BAB4A1E28     ..)M..._B......n..v.q.4c.T..J.(
0079 58D2AD723E426C136FE08DE9F2EF3DFD81E7B4FD81E78CFF7BF22C6012583183     X..r>Bl.o.....=.........{.,`.X1.
0080 B98E7F9144B02A5B1279DF3A94BD4922216258A9EE6DE2FC0CAFE7F906DB712A     ...D.*[.y.:..I"!bX..m........q*
0081 04EEAC155CE6B03C0015F8CE0E4C503B0FF2FCD09407F9F756038778551E263F     ....\\..<.....LP;........V..xU.&?
0082 DB0CC333D98F0BACE22422E518C72BBDCA2BAEF33B1B612FF00D76292ACA650E     ...3.....\$"...+..+..;.a/..v)*.e.
0083 D97529C9D90E56871AB9EB206383157EC373325DD2E88A678FC04471D1D1BDD9     .u)...V.... c..~.s2]...g..Dq....
0084 0CE2EED56ED4C01EDBA1B63F2D1BE63436CCE9B661C3031B66ECB5135B7923E2     ....n......?-..46...a...f...[y#.
0085 D06B1552DDE1B0554875BC60B76C82AFB46C96B4B86258F1B4EAF9EFDBBE5540     .k.R...UHu.`.l...l...bX.......U\@
0086 C898B2CF5CF61D730E68AA7E0C4D6EEC29C90BD64F215954DA4FE0CCECD71686     ....\\..s.h.~.Mn.)...O!YT.O......
0087 26407E400C26D2486F8AD8DE15B8B998A98E1606D4A0BB6C101FFFEB9F912876     &\@~\@.&.Ho..............l......(v
0088 4DB7A5F343DC587ACBB3D9FCFC8D20C7E8C71F383E79379F13C8735F0AA120D3     M...C.Xz...... ....8>y7...s_.. .
0089 8CAE7077EBB0E8E03BADAA21FC0A5AB5FB9DA11E7D9B5C640EBC61E50678EB3B     ..pw....;..!..Z.....}.\\d..a..x.;
0090 7E5F5FED2EDCEBE2154A26325D96CECB224AA8D439FD83002E1755451A84C6EC     ~__......J&2]..."J..9.....UE....
0091 BA11D035D8A63DA560D70A1B76D711DA56DBF7DCFF6AF5AA910BADC381CDCD0B     ...5..=.`...v...V....j..........
0092 9E29AC5D5C93705BBCFA3DA3BA913CF00CFB615C4602EBA45A5A7E23ED19E332     .).]\\.p[..=...<...a\\F...ZZ~#...2
0093 A1955AF88971558CDBF18B3FDE8B5F46DB3947B7F715C39779C164F271A1B9FB     ..Z..qU....?.._F.9G.....y.d.q...
0094 18F8E665F02A9339C77304B34D559F04E86E746D69CED325AE85AA6AB964FACC     ...e.*.9.s..MU...ntmi..%...j.d..
0095 C551554EDF292434E6DE4BC10B5D84A7645F3BA4E20D9B3467147482B0ED2E30     .QUN.)\$4..K..]..d_;....4g.t....0
0096 AC2E9443AF2B2E495A7E2E0B1D04208F4D313E0596D3146E648B01798712C2E8     ...C.+.IZ~.... .M1>....nd..y....
0097 387D0F46369109787550061BFCEE218B091299823CD5892CD4DC5B60412AF866     8}.F6..xuP....!.....<..,..[`A*.f
0098 02DEC86BA70223AF1520063B73FCB5FCFFB6026C0756E85981AB2BC076107A81     ...k..#.. .;s......l.V.Y..+.v.z.
0099 6BFB1D15E06942D1C812F0EB0A749C50940D4C65B54B591557A1A5223C8670BC     k....iB......t.P..Le.KY.W.."<.p.
0100 DAAF007F8B85D5EDB68B84E45964685927690949E50212CCB956950294D022DE     ...........YdhY'i.I.....V....".
0101 E90CCBC06D7C00877B081C0D0D086CE9989EFCFE51D4886A3A28B18F3070FA8D     ....m|..{.....l.....Q..j:(..0p..
0102 C137806B1CB4C1350ECD59D9C8F9AA566D2F5B9EC3B59472D59D8D9D3550902D     .7.k...5..Y....Vm/[....r....5P.-
0103 0420801A214C16673746B575D0060C1852829DC64C515E9F9948785D8F5F6220     . ..!L.g7F.u....R...LQ^..Hx]._b 
0104 A1A386069A02358877553362601B3CEDEEE02579A6E5BC23D25A5FF346CBB8E9     ......5.wU3b`.<...\%y...#.Z_.F...
0105 C88ADE751886FA65386869ACB1DC004BFF26586EC1A70AB2AA195222EFDD9892     ...u...e8hi....K.&Xn......R"....
0106 7D4858C11E4972B181155BCEE77F3928B35D169094558BBE51A3A92E56EDB8D6     }HX..Ir...[..9(.]...U..Q...V...
0107 1356A9B0E9E13D676B8CE920C68368A8EAAA9E589EED3A35E41D7A7305E23751     .V....=gk.. ..h....X..:5..zs..7Q
0108 66AA3939704B8EB95D400FC9F74C9545260F24C23A5B5B9C717838F216B30555     f.99pK..]\@...L.E&.\$.:[[.qx8....U
0109 0C0FD4E6906544F5CEEAE07A392F080DA169357C7D648D70C596E47F6A6DB747     .....eD....z9/...i5|}d.p...jm.G
0110 0F0DA3D79C93090EAA01F9A73B88FE96413071CED2FC7012B11C189510612C59     ............;...A0q...p......a,Y
0111 F1977A68CF58F33F8511AF08F2A93987003465B480853BC38322521F6B05BD1C     ..zh.X.?......9..4e...;.."R.k...
0112 9119A2557FD327EC9AB3CAB0DA762B6AA7A897A258401CABE73EA752AE01000D     ...U.'......v+j....X\@...>.R....
0113 23EED8B431BDCF48BD55DFD2F9D835ED58B098B1656D3A769486EE6765656168     #...1..H.U....5.X...em:v...geeah
0114 E5E22256283EE711CCF6C1EC8E4DFBCAEFB9E4557A821A079B04E986C2E4B5C5     .."V(>.......M.....Uz...........
0115 6DA701B98779B88BD7BAC53CA01F327BADFA4EB580F414FFF4E31643D599D64A     m....y.....<..2{..N........C...J
0116 1323DCD816B98E1EAB0BA09A8A80C54F7A55423E29445C460ACFF756A4D79A8C     .#.............OzUB>)D\\F...V....
0117 B12E2EAEBAEE0730C644E4FA14DE452979D44537847857DF7F2ED6592A68DCD9     .......0.D....E)y.E7.xW...Y*h..
0118 63807002D4E9C32437F5097EF9044FA474DCF560DECFA75D7741854DD6D94181     c.p....\$7..~..O.t..`...]wA.M..A.
0119 260D2648ACC904BDAB992AF410C752D112B2C74E2D86232CF8ADB87E4C608D67     &.&H......*...R....N-.#,...~L`.g
0120 863B29F19487D874DC0E6D48909E51C8413A6EFB5811AD9F32E8A219E37A8899     .;)....t..mH..Q.A:n.X...2....z..
0121 2067B4938FD081796D3DC5D04505B37A0ABD14148CEE241160803A086152A762      g.....ym=..E..z......\$.`.:.aR.b
0122 AED6543FE96022716D941C8FFB3E24E7108BDE440A4A87900BCF11DE0CDF10B7     ..T?.`"qm....>\$....D.J..........
0123 7C2FE8827EC158B98B4667F0A25038F2BB52C542742A0F0BEC350979531DB8E8     |/..~.X..Fg..P8..R.Bt*...5.yS...
0124 208499F82B57119E70E8A0807978CDD62C853CF221F94091B66BD821CC4615EF      ...+W..p...yx..,.<.!.\@..k.!.F..
0125 74110CF1F08C7E92006B103144478A76D106F55284E50569AD2A4A5DC6EBA0F6     t.....~..k.1DG.v...R...i.*J]....
0126 615ACE194D55624D005458E727A7DD53E3C3D44C80896999E729EF14C8877981     aZ..MUbM.TX.'..S...L..i..)....y.
0127 586505ABEF06EB12FAE85AF0383A602BD39E7DCA8A15CEBB997E544D0FA4BA5D     Xe........Z.8:`+..}......~TM...]
0128 04302D4F4B9D50778D8916EF0B9E27EA22409387C776370A7D2B7991CA2E76D0     .0-OK.Pw......'."\@...v7.}+y...v.
0129 E84D210EC9B4B7BA4D2768F82E58ACE7E51652B47CAFB2186284C1ADA41E4A0C     .M!.....M'h..X....R.|...b.....J.
0130 B184507CC53A6860E4733CFFF91202192E51ACAEEE30957AC3E760F1366997D8     ..P|.:h`.s<......Q...0.z..`.6i..
0131 68139F56CBE95CCC66FBBC599503AAFDD74F3FFEF423A4AAF8B175613C03FBA5     h..V..\\.f..Y.....O?..#....ua<...
0132 631E7DB84F6D7206B131FB8C2911FF02DF1D709DD5832D73CED2B87FC53618A1     c.}.Omr..1..).....p...-s....6..
0133 484C65DA8D7765223A934B1EC729BB7756B50AAD2A9CEAEB508A590BD19F954A     HLe..we":.K..).wV...*...P.Y....J
0134 89ACBF8030644D3755DEDE6476ADA39FAE533F2B7426FED088A3BB6EA43813BD     ....0dM7U..dv....S?+t&.....n.8..
0135 1BC28F6DBE5260CF861CC2F448985680A1045B3F8AF59D4E35F0BC9C986BEFB6     ...m.R`.....H.V...[?...N5....k..
0136 3B6A77981EE53F6348CF105A3FE7906EE872190CA64F1D60D977B7DB7597FEDF     ;jw...?cH..Z?..n.r...O.`.w..u...
0137 41E8F60AF9C928C2085708C4E8F271131DDBA67305A734A3B12EA91104D8DFF1     A.....(..W....q....s..4.........
0138 6DD7C01026FE9041A731F92BE03FAE8A18A686A6A31A0C9F53DB74B4306560AF     m...&..A.1.+.?..........S.t.0e`.
0139 694EB39A5E1F8CBCD6C4B07DF2B2C047E1BADB981E633985B54CDB937BF7A91C     iN..^......}...G.....c9..L..{...
0140 1958381599A2105EFEA067EF5052D33E1146DC1DD4A663154D6A023E467534BB     .X8....^..g.PR.>.F....c.Mj.>Fu4.
0141 43EE79D86A6C3A978BAEE55573D2DDD0C6A002A75FE53A53A6700B4FDE4FB9A6     C.y.jl:....Us......._.:S.p.O.O..
0142 72F0AB6CC5B0AC0CA970AA51DEC195E914D2041F5120DF8B0AB5076D1CD32969     r..l.....p.Q........Q .....m..)i
0143 F4E275FA6F68607A7249E0568D9422E29867773434CC4ED5B0390C6A6E673A37     ..u.oh`zrI.V.."..gw44.N..9.jng:7
0144 ADDB9D8B0C7432D54F24EC9F08BEA7A93A6C56B360DAB202C4D767D5D17AFD20     .....t2.O\$......:lV.`.....g..z. 
0145 ABF5F7F72DDBAEA1203029F88A461BF2165C6EB360FF499C30F4FB2E78A5A356     ....-... 0)..F...\\n.`.I.0...x..V
0146 CE7D04562D1A60FACBC15F52886953ADDB9D90DB7FED0C926D5971E4E3D6F46F     .}.V-.`..._R.iS........mYq....o
0147 F1C9DABD477F35A77A47FD37C869D733C0163E7B0D2AD74F989FFC072E0D31AD     ....G5.zG.7.i.3..>{.*.O......1.
0148 693E0000                                                             i>..                            
END_OF_AMAZON

	}
	else
	{
  print <<END_OF_GOOGLE;
0000 3765640D0A436F6E74656E742D547970653A20746578742F786D6C0D0A436F6E     7ed..Content-Type: text/xml..Con
0001 74656E742D4C6F636174696F6E3A20687474703A2F2F7777772E676F6F676C65     tent-Location: http://www.google
0002 2E636F6D2F0D0A5365742D436F6F6B69653A2053455353494F4E49443D363042     .com/..Set-Cookie: SESSIONID=60B
0003 4F583B4D61782D4167653D3433323030300D0A4E6F76617272612D506167652D     OX;Max-Age=432000..Novarra-Page-
0004 49643A203136313433313133310D0A4E6F76617272612D5552493A2068747470     Id: 161431131..Novarra-URI: http
0005 3A2F2F7777772E676F6F676C652E636F6D2F0D0A436F6E74656E742D4C656E67     ://www.google.com/..Content-Leng
0006 74683A20313833300D0A0D0A3C6F62626D6C2062617365687265663D22687474     th: 1830....<obbml basehref="htt
0007 703A2F2F7777772E676F6F676C652E636F6D2F223E3C686561643E3C7469746C     p://www.google.com/"><head><titl
0008 653E476F6F676C653C2F7469746C653E3C2F686561643E3C626F6479206C696E     e>Google</title></head><body lin
0009 6B3D222330303030636322206267636F6C6F723D22236666666666662220636F     k="#0000cc" bgcolor="#ffffff" co
0010 6C6F723D22233030303030302220766C696E6B3D2223353531613862223E3C70     lor="#000000" vlink="#551a8b"><p
0011 20616C69676E3D2263656E746572223E3C7461626C6520636F6C733D22312220      align="center"><table cols="1" 
0012 726F77733D22312220626F726465723D2230222063656C6C70616464696E673D     rows="1" border="0" cellpadding=
0013 2230222063656C6C73706163696E673D2230223E3C74723E3C74643E3C696D67     "0" cellspacing="0"><tr><td><img
0014 20703D22323922206865696768743D22313130222077696474683D2232373622      p="29" height="110" width="276"
0015 20616C743D22476F6F676C6522207372633D222F696D616765732F6C6F676F2E      alt="Google" src="/images/logo.
0016 676966222F3E3C2F74643E3C2F74723E3C2F7461626C653E3C62722F3E3C7461     gif"/></td></tr></table><br/><ta
0017 626C6520636F6C733D2231322220726F77733D22322220626F726465723D2230     ble cols="12" rows="2" border="0
0018 222063656C6C70616464696E673D2230222063656C6C73706163696E673D2230     " cellpadding="0" cellspacing="0
0019 223E3C74723E3C74643E3C2F74643E3C7464206267636F6C6F723D2223333336     "><tr><td></td><td bgcolor="#336
0020 366363223E3C623E3C666F6E7420636F6C6F723D2223666666666666223E5765     6cc"><b><font color="#ffffff">We
0021 623C2F666F6E743E3C2F623E3C2F74643E3C74643E3C2F74643E3C7464206267     b</font></b></td><td></td><td bg
0022 636F6C6F723D2223656665666566223E3C666F6E7420636F6C6F723D22233030     color="#efefef"><font color="#00
0023 30306363223E3C6120703D2236362220687265663D222F696D6768703F686C3D     00cc"><a p="66" href="/imghp?hl=
0024 656E267461623D77692669653D5554462D38223E496D616765733C2F613E3C2F     en&tab=wi&ie=UTF-8">Images</a></
0025 666F6E743E3C2F74643E3C74643E3C2F74643E3C7464206267636F6C6F723D22     font></td><td></td><td bgcolor="
0026 23656665666566223E3C666F6E7420636F6C6F723D2223303030306363223E3C     #efefef"><font color="#0000cc"><
0027 6120703D2238342220687265663D222F67727068703F686C3D656E267461623D     a p="84" href="/grphp?hl=en&tab=
0028 77672669653D5554462D38223E47726F7570733C2F613E3C2F666F6E743E3C2F     wg&ie=UTF-8">Groups</a></font></
0029 74643E3C74643E3C2F74643E3C7464206267636F6C6F723D2223656665666566     td><td></td><td bgcolor="#efefef
0030 223E3C666F6E7420636F6C6F723D2223303030306363223E3C6120703D223130     "><font color="#0000cc"><a p="10
0031 322220687265663D222F64697268703F686C3D656E267461623D77642669653D     2" href="/dirhp?hl=en&tab=wd&ie=
0032 5554462D38223E4469726563746F72793C2F613E3C2F666F6E743E3C2F74643E     UTF-8">Directory</a></font></td>
0033 3C74643E3C2F74643E3C7464206267636F6C6F723D2223656665666566223E3C     <td></td><td bgcolor="#efefef"><
0034 666F6E7420636F6C6F723D2223303030306363223E3C6120703D223132302220     font color="#0000cc"><a p="120" 
0035 687265663D222F6E777368703F686C3D656E267461623D776E2669653D555446     href="/nwshp?hl=en&tab=wn&ie=UTF
0036 2D38223E4E6577733C2F613E3C2F666F6E743E3C2F74643E3C74643E3C2F7464     -8">News</a></font></td><td></td
0037 3E3C2F74723E3C74723E3C746420636F6C7370616E3D22313222206267636F6C     ></tr><tr><td colspan="12" bgcol
0038 6F723D2223333336366363223E3C2F74643E3C2F74723E3C2F7461626C653E3C     or="#3366cc"></td></tr></table><
0039 62722F3E3C7461626C6520636F6C733D22332220726F77733D2231222063656C     br/><table cols="3" rows="1" cel
0040 6C70616464696E673D2230222063656C6C73706163696E673D2230223E3C7472     lpadding="0" cellspacing="0"><tr
0041 3E3C74643E3C2F74643E3C74643E3C696E70757420703D22313631222076616C     ><td></td><td><input p="161" val
0042 75653D2222206D61786C656E6774683D22323536222073697A653D2235352220     ue="" maxlength="256" size="55" 
0043 6E616D653D2271222F3E3C62722F3E3C696E70757420703D2231363722207479     name="q"/><br/><input p="167" ty
0044 70653D227375626D6974222076616C75653D22476F6F676C6520536561726368     pe="submit" value="Google Search
0045 22206E616D653D2262746E47222F3E3C696E70757420703D2231373122207479     " name="btnG"/><input p="171" ty
0046 70653D227375626D6974222076616C75653D2249276D204665656C696E67204C     pe="submit" value="I'm Feeling L
0047 75636B7922206E616D653D2262746E49222F3E3C2F74643E3C74643E95203C61     ucky" name="btnI"/></td><td>. <a
0048 20703D223138312220687265663D222F616476616E6365645F7365617263683F      p="181" href="/advanced_search?
0049 686C3D656E223E416476616E636564205365617263683C2F613E3C62722F3E95     hl=en">Advanced Search</a><br/>.
0050 203C6120703D223138362220687265663D222F707265666572656E6365733F68      <a p="186" href="/preferences?h
0051 6C3D656E223E507265666572656E6365733C2F613E3C62722F3E95203C612070     l=en">Preferences</a><br/>. <a p
0052 3D223139312220687265663D222F6C616E67756167655F746F6F6C733F686C3D     ="191" href="/language_tools?hl=
0053 656E223E4C616E677561676520546F6F6C733C2F613E3C2F74643E3C2F74723E     en">Language Tools</a></td></tr>
0054 3C2F7461626C653E3C62722F3E3C6120703D223139382220687265663D222F61     </table><br/><a p="198" href="/a
0055 64732F223E41647665727469736520776974682055733C2F613E202D203C6120     ds/">Advertise with Us</a> - <a 
0056 703D223230322220687265663D222F73657276696365732F223E427573696E65     p="202" href="/services/">Busine
0057 737320536F6C7574696F6E733C2F613E202D203C6120703D2232303622206872     ss Solutions</a> - <a p="206" hr
0058 65663D222F6F7074696F6E732F223E53657276696365732026616D703B20546F     ef="/options/">Services &amp; To
0059 6F6C733C2F613E202D203C6120703D223231302220687265663D222F61626F75     ols</a> - <a p="210" href="/abou
0060 742E68746D6C223E4A6F62732C2050726573732C2026616D703B2048656C703C     t.html">Jobs, Press, &amp; Help<
0061 2F613E3C703E26636F70793B3230303320476F6F676C65202D20536561726368     /a><p>&copy;2003 Google - Search
0062 696E6720332C3330372C3939382C373031207765622070616765733C2F703E3C     ing 3,307,998,701 web pages</p><
0063 2F703E3C2F626F64793E3C2F6F62626D6C3E0D0A                             /p></body></obbml>..    
END_OF_GOOGLE
  	}
}

print "</textarea><br><input name=submit type=submit value='Extract and Clean XML !'>";
print "<input type=submit name=example value='Show me example uncompressed data !'>";
print "<input type=submit name=example value='Show me example compressed data !'>";
print "<input type=submit name=reset value=Reset></form>";
print "<script>document.forms[0].elements[0].select();</script>";

print "<a href='mailto:jwerwath\@novarra.com'>Comments, complaints, suggestions, bugs, etc.</a><hr>";

$debug = "";

@lines = ();
if ($data && $submit)
{
   @lines = split(/\n/,$data);
   print "LINES=" . $#lines . "<br>";
}
else
{
  print "NO DATA";
  exit 0;
}

$xml = "";
if ($data)
{

  #      . . . . 5 . . . . 0 . . . . 5 . . . . 0 . . . . 5 . . . . 0 . .
  #0000 3C6F62626D6C2062617365687265663D22687474703A2F2F7777772E73636973     <obbml basehref="http://www.scis

$allContent = "";
$out = "";
$allHexData = "";

foreach (@lines)
{
   chop;
   if (/([0-9A-F]{4,4}) ([0-9A-F ]{64,64})     (.*)/)
   {
        $address = $1;
        $hexData = $2;
        $content = $3;

	$allContent .= $content;
	$allHexData .= $hexData;
			
   }
   else #we are not parsing any obbml at this point
   {
	   $out = $out . "<b>I DID NOT UNDERSTAND THIS LINE:</b> $_ <br>";
   }#endif

}#end foreach line of the RFTRACE

#Get rid of newlines
#$allContent =~ s/\n//g;
#
if ($allContent =~ /Content-Encoding:\s+gzip/)
{
	$filename = &randomFileName("tmp","txt");

	#Cut of the headers and just get the contnet
	$allHexData = &extractHexContentFromRFTRACE(@lines);

	$bytes = &hexDumpStringToBinaryFile($allHexData,$filename);
	$result = &command2String("gzip -d -c $filename");
	unlink($filename);
	#$out .= "<b>$bytes BYTES in $filename</b><br>";
	$out = $out . &nicexml($result);  
	#$out = $out . "<hr>" . $result;     
}
else
{
	$out = $out . &nicexml($allContent);
}

}#endif data


print "<hr>";

if ($data)
{
   print "<pre>$out</pre>";
}



sub nicexml
{
   my $xml = shift;

   my $output = "";
  #each tag or end tag begins on new line.
  $xml =~ s/</\n</g;
  

  @xmllines = split(/\n/,$xml);
  $indent = 0;
  $output = "";
 foreach (@xmllines)
  {
   
    #---START TAG
    if (/^<\w/)
    {
       $indent = $indent + 1;
    }

    

    

    #--- Do indenting
    foreach $i (0 .. $indent)
    {
      $_ = $HTML_SPACE . $_; 
    }


    #--- Debug indenting
    #$_ = $indent . ":" . $_ ;
    


   

    if (/\/>/) #self-closing tag
    {
        $indent = $indent - 1;
    }

    elsif (/<\//)
    {
       $indent = $indent - 1;
      
    }

    #---Make < and > HTML printable
    s/</&lt;/;
    s/>/&gt;/;
    s/\r//g;
    s/\s/ /g;
    

 #--- Add what we have to total output.
    $output = $output . "$_". "\n";

    

  #if end tag

  }#end foreach
  return $output;
}#end sub





